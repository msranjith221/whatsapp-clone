- create a file under /src/components/home/user-list-dialog.tsx

```tsx
import { useRef, useState } from "react";
import Image from "next/image";
import { Avatar, AvatarFallback, AvatarImage } from "@/components/ui/avatar";
import {
	Dialog,
	DialogContent,
	DialogDescription,
	DialogHeader,
	DialogTitle,
	DialogTrigger,
} from "@/components/ui/dialog";
import { Input } from "../ui/input";
import { Button } from "../ui/button";
import { ImageIcon, MessageSquareDiff } from "lucide-react";
import { users } from "@/dummy-data/db";

const UserListDialog = () => {
	const [selectedUsers, setSelectedUsers] = useState<Id<"users">[]>([]);
	const [groupName, setGroupName] = useState("");
	const [isLoading, setIsLoading] = useState(false);
	const [selectedImage, setSelectedImage] = useState<File | null>(null);
	const [renderedImage, setRenderedImage] = useState("");
	const imgRef = useRef<HTMLInputElement>(null);

	return (
		<Dialog>
			<DialogTrigger>
				<MessageSquareDiff size={20} />
			</DialogTrigger>
			<DialogContent>
				<DialogHeader>
					{/* TODO: <DialogClose /> will be here */}
					<DialogTitle>USERS</DialogTitle>
				</DialogHeader>

				<DialogDescription>Start a new chat</DialogDescription>
				{renderedImage && (
					<div className='w-16 h-16 relative mx-auto'>
						<Image src={renderedImage} fill alt='user image' className='rounded-full object-cover' />
					</div>
				)}
				{/* TODO: input file */}
				{selectedUsers.length > 1 && (
					<>
						<Input
							placeholder='Group Name'
							value={groupName}
							onChange={(e) => setGroupName(e.target.value)}
						/>
						<Button className='flex gap-2'>
							<ImageIcon size={20} />
							Group Image
						</Button>
					</>
				)}
				<div className='flex flex-col gap-3 overflow-auto max-h-60'>
					{users?.map((user) => (
						<div
							key={user._id}
							className={`flex gap-3 items-center p-2 rounded cursor-pointer active:scale-95 
								transition-all ease-in-out duration-300
							${selectedUsers.includes(user._id) ? "bg-green-primary" : ""}`}
							onClick={() => {
								if (selectedUsers.includes(user._id)) {
									setSelectedUsers(selectedUsers.filter((id) => id !== user._id));
								} else {
									setSelectedUsers([...selectedUsers, user._id]);
								}
							}}
						>
							<Avatar className='overflow-visible'>
								{user.isOnline && (
									<div className='absolute top-0 right-0 w-2.5 h-2.5 bg-green-500 rounded-full border-2 border-foreground' />
								)}

								<AvatarImage src={user.image} className='rounded-full object-cover' />
								<AvatarFallback>
									<div className='animate-pulse bg-gray-tertiary w-full h-full rounded-full'></div>
								</AvatarFallback>
							</Avatar>

							<div className='w-full '>
								<div className='flex items-center justify-between'>
									<p className='text-md font-medium'>{user.name || user.email.split("@")[0]}</p>
								</div>
							</div>
						</div>
					))}
				</div>
				<div className='flex justify-between'>
					<Button variant={"outline"}>Cancel</Button>
					<Button
						disabled={selectedUsers.length === 0 || (selectedUsers.length > 1 && !groupName) || isLoading}
					>
						{/* spinner */}
						{isLoading ? (
							<div className='w-5 h-5 border-t-2 border-b-2  rounded-full animate-spin' />
						) : (
							"Create"
						)}
					</Button>
				</div>
			</DialogContent>
		</Dialog>
	);
};
export default UserListDialog;
```
```tsx
- In left-panel.tsx replace <MessageSquareDiff size={20} /> with <UserListDialog />
```
- create file /convex/conversations.ts

- use below command to get Success, Error, Emoji etc.. Symbols
```bash
npm install react-hot-toast
```
```tsx
- to display ourself(to implement "Message yourself" feature) in UI, on click, <UserListDialog /> (/src/components/home/left-panel.tsx) => 
<DialogTrigger><MessageSquareDiff size={20} /></DialogTrigger> (/src/components/home/user-list-dialog.tsx), do following:
```
In /convex/users.ts, 
```ts
export const getUsers = query({
	...
		return users.filter((user) => user.tokenIdentifier !== identity.tokenIdentifier);
	},
});
```
change: return users.filter((user) => user.tokenIdentifier !== identity.tokenIdentifier);
to: return users; 

```bash
npm install zustand
```
- create folder, /src/store
- create file, /src/store/chat-store.ts

- create /convex/messages.ts
```bash
npm install emoji-picker-react
```

- create folder /src/hooks
- create /src/hooks/useComponentVisible.ts
- create /src/components/home/chat-bubble-avatar.tsx
- create /src/components/home/date-indicator.tsx
- create /src/components/home/media-dropdown.tsx

```bash
npm install react-player
```

- Inorder to make The Image appear on UI, instead of just the URL, once we send message(of type "Image"):
make changes to "/next.config.ts" (or .js or .mjs)

```ts
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  /* config options here */
  images: {
		remotePatterns: [
			{ hostname: "ideal-warthog-671.convex.cloud" },
		],
	},
};

export default nextConfig;
```

- create /src/components/home/chat-avatar-actions.tsx

- Go to https://platform.openai.com , under settings | Organization | select API keys
- select "Create new secret key", Name: whatsapp-clone, select "Create secret key"
- Copy the secret key, Paste in Convex Dashboard | Settings | Environment Variables, create
Environment Variable, select "Add", Name: OPENAI_API_KEY, Value: "paste secret key here"

- create /convex/openai.ts

```bash
npm install openai
```
- signup to zegocloud, https://www.zegocloud.com/ (video call API for whatsapp-clone)
- select "create your first project", select "Start with UIKits", Select "For Web"
- get the "AppID" and "ServerSecret" from ZEGO and paste in the .env.local file
NEXT_PUBLIC_ZEGO_APP_ID=AppID
NEXT_PUBLIC_ZEGO_SERVER_SECRET=ServerSecret

- go to https://www.zegocloud.com/ | Developers | Documentation | Video Call | select "Web: JavaScript" | under "Video Call", select "Call Kit"
- select "using NPM package manager", for setup-guide (https://www.zegocloud.com/article/14935)

```bash
npm i @zegocloud/zego-uikit-prebuilt --save
```

- create folder /src/app/video-call
- create file /src/app/video-call/page.tsx
- create file /src/app/video-call/video-ui-kit.tsx

# STARTER CODE => /src/app/video-call/video-ui-kit.tsx 

```tsx
import { ZegoUIKitPrebuilt } from "@zegocloud/zego-uikit-prebuilt";

function randomID(len: number) {
	let result = "";
	if (result) return result;
	var chars = "12345qwertyuiopasdfgh67890jklmnbvcxzMNBVCZXASDQWERTYHGFUIOLKJP",
		maxPos = chars.length,
		i;
	len = len || 5;
	for (i = 0; i < len; i++) {
		result += chars.charAt(Math.floor(Math.random() * maxPos));
	}
	return result;
}

export function getUrlParams(url = window.location.href) {
	let urlStr = url.split("?")[1];
	return new URLSearchParams(urlStr);
}

const appID = +process.env.NEXT_PUBLIC_ZEGO_APP_ID!;
const serverSecret = process.env.NEXT_PUBLIC_ZEGO_SERVER_SECRET!;

export default function VideoUIKit() {
	const roomID = getUrlParams().get("roomID") || randomID(5);

	let myMeeting = (element: HTMLDivElement) => {
		// generate Kit Token
		const kitToken = ZegoUIKitPrebuilt.generateKitTokenForTest(
			appID,
			serverSecret,
			roomID,
			randomID(5),
			randomID(5)
		);

		const zp = ZegoUIKitPrebuilt.create(kitToken);
		zp.joinRoom({
			container: element,
			sharedLinks: [
				{
					name: "Personal link",
					url:
						window.location.protocol +
						"//" +
						window.location.host +
						window.location.pathname +
						"?roomID=" +
						roomID,
				},
			],
			scenario: {
				mode: ZegoUIKitPrebuilt.GroupCall, // To implement 1-on-1 calls, modify the parameter here to [ZegoUIKitPrebuilt.OneONoneCall].
			},
		});
	};

	return <div className='myCallContainer' ref={myMeeting} style={{ width: "100vw", height: "100vh" }}></div>;
}
```

- In the setup-guide (https://www.zegocloud.com/article/14935), Under, Initialize the SDK, click link "this"(https://www.zegocloud.com/article/14741)
under "Generate a Token on your app server (recommended)", In Node.js column, select "Github" (https://github.com/ZEGOCLOUD/zego_server_assistant/tree/master/token/nodejs/server), copy file "zegoServerAssistant.ts"
- create folder /src/app/api
- create folder /src/app/api/zegocloud
- create file /src/app/api/zegocloud/route.ts
- create file /src/app/api/zegocloud/zegoServerAssistant.ts
- update from Github, /src/app/video-call/video-ui-kit.tsx
- make changes in .env.local: 
ZEGO_APP_ID=AppID, 
ZEGO_SERVER_SECRET=ServerSecret 


